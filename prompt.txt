You are to build a highly advanced Telegram bot named JARVIS, designed exclusively for the developer (for now), with the following capabilities, rules, and constraints:

---

ğŸ§© PROJECT PURPOSE:
JARVIS is a private AI-powered assistant integrated into a Telegram bot. It acts like an intelligent developer companion (Jarvis-style), capable of:
- Understanding natural language prompts
- Reading uploaded `.txt` plans
- Generating, modifying, and managing code projects (specifically Telegram bots or utility tools)
- Performing internal file operations (create, read, edit, delete, move files/folders)
- Operating in two modes: "dev-only" and "everyone"

---

ğŸ¯ FUNCTIONAL SCOPE:

1. âœ… **Chat Interface**:
   - Accepts commands and free-text prompts from the dev via Telegram.

2. âœ… **AI-Powered Code Generation**:
   - Uses Gemini (or GPT) to generate or modify codebases based on user input or uploaded `.txt` plans.

3. âœ… **File System Control**:
   - JARVIS can:
     - Create new folders (e.g., `/bots/my_game_bot/`)
     - Create/edit/delete files (e.g., `main.py`, `handlers/`, etc.)
     - Update existing codebases
     - Inject new handlers, utils, features on request

4. âœ… **Plan File Support**:
   - Accepts uploaded `.txt` or `.md` files that contain feature plans
   - Parses and builds bots based on these plans

5. âœ… **Internal Build-Only Mode**:
   - Never sends code back in the chat
   - All code is silently written to disk
   - Confirms actions like: â€œâœ… Project built in /bots/xyz_botâ€

6. âœ… **Retry System (Max 5 Attempts)**:
   - For any operation (build/edit), JARVIS gets up to 5 attempts
   - On failure, it:
     - Explains the error using Gemini in human terms
     - Tries again with adjusted prompt/logic
   - On success: confirms âœ…
   - On full failure: replies with â€œâŒ All 5 attempts failed. Reason: â€¦â€

7. âœ… **Access Control System**:
   - Default mode is `"dev-only"` (only the dev's Telegram user ID is allowed)
   - Can be toggled using:
     - "Jarvis, switch to public mode" â†’ sets `access_mode = "everyone"`
     - "Jarvis, switch back to dev mode" â†’ sets `access_mode = "dev"`

8. âœ… **Persistent Config**:
   - Settings like `access_mode`, allowed user IDs, etc., are stored in a JSON file (e.g., `config/settings.json`)

9. âœ… **Silent Logger**:
   - Logs all actions (success/failure) and errors internally (e.g., `logs/errors.log`)

---

ğŸ§  INTELLIGENT ERROR HANDLING:
- All errors (e.g., JSON parsing errors, file permission errors, invalid code) are:
  - Caught and logged
  - Sent to Gemini with a follow-up prompt: â€œExplain this error simplyâ€
  - Human-friendly error summaries are sent to the user
  - Auto-retries until max 5 attempts

---

ğŸ‘®â€â™‚ï¸ PERMISSIONS & SECURITY:

- Access to JARVIS is restricted to the dev (via Telegram user ID)
- File operations are restricted to safe base paths like:
  - `/bots/`
  - `/shared/`
  - `/config/`
- No shell command execution
- Optional: all user requests and file changes are logged

---

ğŸ› ï¸ CODE STRUCTURE (TO BE GENERATED BY JARVIS):

jarvis_bot/
â”œâ”€â”€ main.py # Telegram bot entrypoint
â”œâ”€â”€ jarvis_engine.py # Talks to Gemini or GPT
â”œâ”€â”€ file_manager.py # Create, update, delete files
â”œâ”€â”€ parser.py # Parses uploaded plan.txt files
â”œâ”€â”€ error_handler.py # AI-powered error explainer
â”œâ”€â”€ config/
â”‚ â””â”€â”€ settings.json # Stores access_mode and allowed user_ids
â”œâ”€â”€ logs/
â”‚ â””â”€â”€ errors.log # Tracks retries/errors
â”œâ”€â”€ bots/ # Where generated bots are created
â”‚ â””â”€â”€ my_game_bot/
â”‚ â”œâ”€â”€ main.py
â”‚ â”œâ”€â”€ handlers/
â”‚ â””â”€â”€ db/


---

ğŸ“¦ INCLUDED FEATURES:
- Silent build mode âœ…
- Retry system with AI explanations âœ…
- Access mode switch (dev/public) âœ…
- Logger and error tracking âœ…
- No code replies in chat âœ…
- Plan parsing from uploaded `.txt` âœ…
- Role-safe bot creation (no self-token handling) âœ…

---

ğŸ›¡ï¸ FUTURE UPGRADE PLAN (optional, not required now):
- Add multi-user roles (dev, contributor, viewer)
- GUI panel or Web UI (Flask + Auth)
- Project cloning and forking
- Versioning and rollback (via git or snapshots)

---

âš ï¸ RESTRICTIONS:
- JARVIS must not reply with raw code blocks
- JARVIS must not perform actions outside allowed folders
- JARVIS must only obey authenticated commands

---

ğŸ”š END OF SPEC
